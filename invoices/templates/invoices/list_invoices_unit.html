{% extends 'base.html' %}
{% load static %}
{% load humanize %}
{% block content %}
<div class="container pt-5">
    <div class="row mb-3">
        <div class="col-3 col-sm-2 col-md-2 col-lg-2  ">
            <a href="{% url 'main:unit_details' countyCardSlug unit.slug %}" class="btn-menu">
                <span class="bi bi-arrow-90deg-left custom-icon"></span>
            </a>
        </div>
        <div class="col-8 col-sm-8 col-md-8 col-lg-8 d-flex align-items-center justify-content-center">
            <div>
                <h5 class="h5 m-0 font-weight-bold">{{unit}}</h5>
            </div>
        </div>
        <div class="col-3 col-sm-2 col-md-2 col-lg-2 d-flex justify-content-end">
            <div class="mx-2">
                <a class="btn-menu" data-url="{% url 'main:archiveYears' unit.slug paragraph.slug %}" onclick="openArchiveModal(this)"
                   data-toggle="info" title="Archiwum">
                    <i class="bi bi-archive-fill custom-icon"></i>
                </a>
            </div>
            {% if user.is_authenticated %}
            <div class="">
                <a class="btn-menu" href="{% url 'invoices:newInvoice' %}" data-toggle="info" title="Nowa faktura">
                    <i class="bi bi-plus-circle custom-icon"></i>
                </a>
            </div>
            {% endif %}
        </div>
    </div>
    {% if unit.object_name %}
    <div class="d-flex justify-content-center">
        <h5 class="h5">{{unit.object_name}}</h5>
    </div>
    {% endif %}
    <div class="text-center text-uppercase my-2 ">Dokumenty wystawione w {{currentYear}} roku</div>
</div>
<div>
    <div class="d-flex justify-content-center align-items-center py-3">
        <span class="d-flex align-items-end">§ {{ paragraph }} - {{ paragraph.name }}</span>
    </div>
    <table class="table table-striped table-hover table-caption mb-5">
        <thead class="table-dark">
        <tr class="text-center">
            <th align="center" valign="middle" width="auto" scope="col">Data faktury</th>
            <th align="center" valign="middle" width="auto" scope="col">Nr. dokumentu</th>
            <th align="center" valign="middle" width="auto" scope="col">Rodzaj dokumentu</th>
            <th align="center" valign="middle" width="auto" scope="col">Okres</th>
            <th align="center" valign="middle" width="auto" scope="col">Nr. licznika</th>
            <th align="center" valign="middle" width="auto" scope="col">Stan licznika</th>
            <th align="center" valign="middle" width="auto" scope="col">Zużycie</th>
            <th align="center" valign="middle" width="auto" scope="col">Kwota</th>
            <th align="center" valign="middle" width="auto" scope="col">Informacja</th>
        </tr>
        </thead>
        <tbody>
        {% for item in items %}
        <tr>
            <td align="center" valign="middle" width="120" scope="col">
                {{ item.invoice_id.date }}
            </td>
            <td align="left" valign="middle" width="180" scope="col">
                <a data-url="{% url 'invoices:infoInvoice' item.invoice_id.id %}" onclick="openInvoiceInfoModal(this)">
                    {{ item.invoice_id.no_invoice }}
                </a>
            </td>
            <td align="center" valign="middle" width="150" scope="col">
                {{ item.invoice_id.doc_types }}
            </td>
            <td align="center" valign="middle" width="200" scope="col">
                {{ item.period_from }} - {{ item.period_from }}
            </td>
            <td align="center" valign="middle" width="180" scope="col">
                {{ item.measurementSystemNumber }}
            </td>
            <td align="center" valign="middle" width="180" scope="col">
                {{ item.counterReading }}
            </td>
            <td align="center" valign="middle" width="auto" scope="col">
                {{ item.consumption }} kWh
            </td>
            <td align="right" valign="middle" width="auto" scope="col">
                {{ item.sum|intcomma }} zł
            </td>
            <td align="left" valign="middle" width="450" scope="col">
                {{ item.information|default_if_none:'' }}
            </td>
            <!-- Dodaj inne wybrane propertisy tutaj -->
        </tr>
        {% endfor %}
        </tbody>
        <tfoot>
        <tr>
            <th colspan="5">Ostatnia aktualizacja: {{lastUpdate.creation_date|date:'d.m.Y'}} r.</th>
        </tr>
        </tfoot>
    </table>
</div>
<!-- Modal -->
<div class="modal fade" id="invoiceInfoModal">
    <div class="modal-dialog modal-xl" role="document">
        <div class="modal-content">
        </div>
    </div>
</div>
<div class="modal fade" id="archiveModal">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
        </div>
    </div>
</div>
<script type="text/javascript">
    function openInvoiceInfoModal(button){
        var url = $(button).data("url");
        $("#invoiceInfoModal .modal-content").load(url);
        $("#invoiceInfoModal").modal("show");
    }
    function openArchiveModal(button){
        var url = $(button).data("url");
        $("#archiveModal .modal-content").load(url);
        $("#archiveModal").modal("show");
    }
</script>
{% endblock %}